import{E as T,_ as y,d as S,G as F,f as a,o as l,h as u,j as c,r as H,z as x,t as s,u as h,i as m,H as z,l as C,v as L,s as v,p as U,q as M,w as $,x as r,I,y as w,A as p,C as _,J as E}from"./_plugin-vue_export-helper-DGKz3gaZ.chunk.mjs";import{d as k,t as o,l as R}from"./logger-B1Py-Phv.chunk.mjs";const j={name:"HelpCircleIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},q=["aria-hidden","aria-label"],B=["fill","width","height"],G={d:"M15.07,11.25L14.17,12.17C13.45,12.89 13,13.5 13,15H11V14.5C11,13.39 11.45,12.39 12.17,11.67L13.41,10.41C13.78,10.05 14,9.55 14,9C14,7.89 13.1,7 12,7A2,2 0 0,0 10,9H8A4,4 0 0,1 12,5A4,4 0 0,1 16,9C16,9.88 15.64,10.67 15.07,11.25M13,19H11V17H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z"},J={key:0};function Z(e,t,i,f,D,A){return l(),a("span",z(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon help-circle-icon",role:"img",onClick:t[0]||(t[0]=n=>e.$emit("click",n))}),[(l(),a("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[u("path",G,[i.title?(l(),a("title",J,s(i.title),1)):c("",!0)])],8,B))],16,q)}const K=y(j,[["render",Z]]);T();const O={class:"settings-section"},P={class:"settings-section__name"},Q=["aria-label","href","title"],W={key:0,class:"settings-section__desc"},X=S({__name:"NcSettingsSection",props:{name:{},description:{default:""},docUrl:{default:""}},setup(e){const t=F("External documentation");return(i,f)=>(l(),a("div",O,[u("h2",P,[x(s(i.name)+" ",1),i.docUrl?(l(),a("a",{key:0,"aria-label":h(t),class:"settings-section__info",href:i.docUrl,rel:"noreferrer nofollow",target:"_blank",title:h(t)},[m(K,{size:20})],8,Q)):c("",!0)]),i.description?(l(),a("p",W,s(i.description),1)):c("",!0),H(i.$slots,"default",{},void 0,!0)]))}}),Y=y(X,[["__scopeId","data-v-9cedb949"]]);async function g(e){try{return await C.put(L("/apps/files_downloadlimit/api/v1/limit"),{limit:e}),!0}catch(t){k.error("Failed to set default download limit",{error:t}),v(o("files_downloadlimit","Failed to set default download limit"))}return!1}async function ee(){try{return await C.delete(L("/apps/files_downloadlimit/api/v1/limit")),!0}catch(e){k.error("Failed to remove default download limit",{error:e}),v(o("files_downloadlimit","Failed to remove default download limit"))}return!1}const b=R("files_downloadlimit","default-download-limit",-1),ie=S({name:"AdminSettings",components:{NcCheckboxRadioSwitch:M,NcSettingsSection:Y,NcTextField:U},data(){return{limit:Math.max(b,10),enableDefaultLimit:b!==-1,showLoading:!1,showSuccess:!1}},computed:{helperText(){return typeof this.limit=="number"&&this.limit<=0?o("files_downloadlimit","The minimum limit is 1"):""}},watch:{async limit(e){await g(e)&&(this.showSuccess=!0,window.setTimeout(()=>{this.showSuccess=!1},1e3))},async enableDefaultLimit(e,t){this.showLoading=!0;let i;e?i=await g(10):i=await ee(),i||(this.enableDefaultLimit=t),this.showLoading=!1}},methods:{t:o}}),te={class:"settings__placeholder"};function le(e,t,i,f,D,A){const n=r("NcCheckboxRadioSwitch"),N=r("NcTextField"),V=r("NcSettingsSection");return l(),I(V,{name:e.t("files_downloadlimit","Download limit"),description:e.t("files_downloadlimit","Configure the default download limit for external shares.")},{default:w(()=>[m(n,{modelValue:e.enableDefaultLimit,"onUpdate:modelValue":t[0]||(t[0]=d=>e.enableDefaultLimit=d),loading:e.showLoading,type:"switch"},{default:w(()=>[x(s(e.t("files_downloadlimit","Default download limit for external shares")),1)]),_:1},8,["modelValue","loading"]),p(m(N,{modelValue:e.limit,"onUpdate:modelValue":t[1]||(t[1]=d=>e.limit=d),class:"settings__field",disabled:!e.enableDefaultLimit||e.showLoading,label:e.t("files_downloadlimit","Set default download limit"),type:"number",min:"1","helper-text":e.helperText,error:!!e.helperText,success:e.showSuccess},null,8,["modelValue","disabled","label","helper-text","error","success"]),[[_,e.enableDefaultLimit]]),p(u("div",te,null,512),[[_,!e.enableDefaultLimit]])]),_:1},8,["name","description"])}const ae=$(ie,[["render",le],["__scopeId","data-v-e84629db"]]);E(ae).mount("#admin-download-limit");
//# sourceMappingURL=files_downloadlimit-admin.mjs.map
