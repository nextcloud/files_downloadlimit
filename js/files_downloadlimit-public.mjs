import{l as w,t as m,a as f}from"./index-BD2PoSOi.chunk.mjs";import{l as p}from"./logger-SLCD81cU.chunk.mjs";const{limit:a,downloads:c}=w("files_downloadlimit","download_limit",{limit:-1,downloads:0});p.debug("Download limit",{limit:a,downloads:c});let t=a-c,r=0;const s=(e,o)=>{o===0?e.innerText=m("files_downloadlimit","You have reached the maximum amount of downloads allowed"):e.innerText=f("files_downloadlimit","1 remaining download allowed","{count} remaining downloads allowed",o,{count:o})};window.addEventListener("DOMContentLoaded",()=>{if(a<1)return;const e=document.getElementById("header-primary-action");if(!e)return;const o=document.createElement("span");o.setAttribute("style","color: var(--color-primary-text); padding: 0 10px;"),o.setAttribute("data-cy-downloads-count-message",`${t}`),o.classList.add("downloads-count-message"),s(o,t),e.prepend(o);const d=document.querySelector("#files-public-content");if(!d)return;d.oncontextmenu=n=>(n.preventDefault(),n.stopPropagation(),!1);const l=Array.from(document.querySelectorAll('a[href*="/download/"]'));new Set(l).forEach(n=>{n.addEventListener("click",i=>{if(r>0&&!confirm(m("files_downloadlimit","This share has a limited number of downloads. Are you sure you want to trigger a new download?"))){i.preventDefault(),i.stopPropagation();return}t--,r++,s(o,t),t===0&&[...l].forEach(u=>u.remove())})})});
//# sourceMappingURL=files_downloadlimit-public.mjs.map
